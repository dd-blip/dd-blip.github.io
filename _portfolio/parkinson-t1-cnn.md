---
title: "基于三维 T1 磁共振影像的帕金森病自动诊断"
collection: portfolio
type: "Machine Learning"
permalink: /portfolio/parkinson-t1-cnn
date: 2026-01-18
excerpt: "基于常规 T1 MRI 与三维卷积神经网络，实现帕金森病的自动分类与模型性能评估。"
header:
  teaser: /images/portfolio/parkinson-t1-cnn/roc_curve.png
tags:
- 医学影像
- 深度学习
- 三维卷积神经网络
- 帕金森病
- 分类模型
tech_stack:
- name: Python
- name: PyTorch
- name: Scikit-learn
- name: NumPy
---

## 项目背景（Background）

帕金森病是一种常见的神经系统退行性疾病，具有起病隐匿、进展缓慢且不可逆的特点。随着病程进展，患者可出现运动功能障碍及多种非运动症状，严重影响生活质量。  
在临床实践中，帕金森病诊断主要依赖症状评估，缺乏客观、自动化的影像辅助诊断手段。

T1 加权磁共振成像作为最常规的脑部结构影像序列，具有获取方便、空间分辨率高、跨中心一致性较好的优势。本项目基于三维 T1 MRI，探索深度学习方法在帕金森病自动诊断中的应用可行性。

---
## 预测模型构建

本项目采用三维卷积神经网络（3D CNN）对全脑 T1 MRI 进行端到端建模。  
模型采用多层编码结构，通过逐级下采样提取从局部解剖结构到全局空间模式的层级特征。

在网络设计上：
- 使用 3D 卷积以显式建模体素间空间关联
- 引入残差连接缓解深层网络训练不稳定问题
- 在编码器末端进行全局特征聚合，用于二分类判别

该设计能够在不依赖显式 ROI 标注的情况下，自动学习与帕金森病相关的结构性差异。

---
## 核心实现（Implementation）

### 数据预处理

- 脑区掩膜约束，去除非脑组织信号
- 基于样本自身的 Z-score 强度归一化
- 训练阶段引入三维空间与强度数据增强

---
## 模型评估与结果展示

模型在独立测试集上进行性能评估，采用多种常用分类指标从不同角度对模型表现进行综合分析。

### 定量评估结果

模型在测试集上的主要评估指标如下：

| 指标 | 数值 |
|------|------|
| Accuracy | 0.758 |
| Precision | 0.750 |
| Recall | 0.774 |
| F1-score | 0.762 |
| AUC | 0.848 |

其中，Recall 指标相对较高，表明模型对帕金森病样本具有较好的检出能力，在降低漏诊风险方面具备一定优势。

### 判别能力分析

通过受试者工作特征曲线（ROC）对模型在不同判别阈值下的整体区分能力进行评估。测试集上的 ROC 曲线对应的曲线下面积（AUC）为 0.848，表明模型能够较好地区分健康对照与帕金森病样本，具有稳定的判别性能。
![ROC 曲线](/images/portfolio/parkinson-t1-cnn/roc_curve.png)

### 预测概率校准分析

除判别能力外，进一步通过校准曲线评估模型输出预测概率的可靠性。校准结果显示，模型预测概率整体趋势接近理想参考线，但在部分中高概率区间仍存在一定偏差。

该结果提示模型在当前设置下具备一定概率可信度，但在实际应用场景中仍可通过概率校准方法进一步优化预测稳定性与可解释性。
![校准曲线](/images/portfolio/parkinson-t1-cnn/calibration_curve.png)

```python
img = img * brain_mask
img = (img - img.mean()) / (img.std() + 1e-6)
